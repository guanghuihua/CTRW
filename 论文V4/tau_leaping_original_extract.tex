%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%   东北师范大学硕士学位论文模板（2023版） v1.0alpha
%%%%%%%%%%%%%%%%   DESIGNED BY ZHAO HONGLIANG
%%%%%%%%%%%%%%%%   在 CTeX_3.0.212.1 中使用  pdflatex 编译通过
%%%%%%%%%%%%%%%%   在 texlive 2022 中使用  pdflatex 编译通过
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%   需将校徽和校名图片文件 xiaohui.png 和 xiaoming.png 放在源程序文件夹中
%%%%%%%%%%%%%%%%   在\begin{document} 命令后输入论文相关信息，用以自动生成封面等
	%%%%%%%%%%%%%%%%   使用 pdflatex 编译
	%%%%%%%%%%%%%%%%   脚注序号为带圈数字，每页最大编号为 10，超过 10 需手动处理
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	%%%%%%%%%%%%%%%%
	%%%%%%%%%%%%%%%%   导言区
	%%%%%%%%%%%%%%%%
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	%%=====================================================================================================%%
	%%
	%%                设置文档类别   和   页面格式
	%%
	%%=====================================================================================================%%
	\documentclass[a4paper,twoside,openany,UTF8]{article}  %A4纸张，双面排版，每章后不留空白页，UTF-8编码
	\usepackage[heading=true]{ctex}  %添加中文及版式的支持
	\usepackage[total={160mm,257mm},inner=25mm,outer=25mm,top=20mm,includeheadfoot,%
	headheight=15mm,headsep=8mm,footskip=17.5mm,centering]{geometry}  % 使用 geomerty 宏包设置页面格式
	\renewcommand{\baselinestretch}{1.25}  %设置行距=默认行距(1.2倍)*1.25=1.5倍
	%%=====================================================================================================%%
	%%
	%%                加载所需宏包，可根据需要增删 （宏包功能可参考 LaTeX 编辑部 网站的简要说明）
	%%
	%%=====================================================================================================%%
	\usepackage{mathrsfs}  % 加载 mathrsfs 字体宏包，在数学中使用 Raph Smith’s Formal Script 字体
	\usepackage{amsmath,amssymb,amsthm}  % 加载数学公式、数学符号、定理和证明排版宏包
	\usepackage{graphicx,curves,epic}  % 加载图形宏包、绘图宏包、绘图宏包
	\usepackage{subfig}  % 加载子图宏包。 subfig 宏包是 subfigure 宏包的升级版，且二者冲突
	\usepackage{tikz,pgfplots,circuitikz}  % 加载绘图、2D3D和散点图绘制、电路图绘制宏包
	\usepackage{xcolor}  % 加载颜色处理宏包，是 color 宏包的加强版
	\usepackage{calc}  % 加载 LaTeX 的算术运算增强宏包
	\usepackage{array,tabularx}  % array 和 tabular 环境功能增强宏包、自动计算表格列宽宏包
	\usepackage{booktabs}  % 表格顶部、中部和底部使用不同粗细的水平线宏包
	\usepackage{tabularray}  % 超好用的新一代表格排版宏包
	\usepackage[labelsep=quad]{caption}  % 加载图表标题宏包，本文设置分隔符为一个\quad
	\usepackage[T1]{fontenc}  % 加载字体宏包，调用 T1 科克编码字体
	\usepackage{extarrows}  % 加载长度自适应箭标宏包
	\usepackage{bm}  % 以粗体方式显示数学公式宏包。它提供一个在数学模式中使用的 \bm{数学式} 命令
	%\usepackage{appendix}  % 加载附录宏包
	\usepackage{float,floatflt}  % 加载新浮动体宏包、图文混排宏包
	%\usepackage{floatrow}  % 加载灵活排版插图和表格浮动体宏包，建议同时加载 graphicx 宏包和 subcaption 宏包
	%\usepackage{graphicx}
	%\usepackage{subcaption}  % 加载设置子标题宏包
	%\usepackage{wrapstuff}  % 加载另一个图文混排宏包
	%%=====================================================================================================%%
	%%
	%%                设置页眉页脚，页眉居中显示东北师范大学硕士学位论文，页脚居中显示页码，页眉有横线
	%%
	%%=====================================================================================================%%
	\usepackage{fancyhdr}  %change page margings and sizes, headers and footers,
	\pagestyle{fancy}   %紧跟 \usepackage{fancyhdr}，
	\fancyhead{}  %清除页眉页脚
	%\fancyhead[L,R]{}  %设置页眉左右位置为空
	\fancyhead[C]{东北师范大学硕士学位论文}  %设置页眉居中位置
	\fancyfoot{}  %清除页脚
	%\fancyfoot[L,R]{}  %设置页角左右位置为空
	\fancyfoot[C]{\thepage}  %设置角眉居中位置显示页码
	\renewcommand{\headrulewidth}{1pt}  %设置页眉线宽度为 1 磅
	%%=====================================================================================================%%
	%%
	%%                 使用 CTeX 宏包设置节、小节、小小节标题格式
	%%
	%%=====================================================================================================%%
	\ctexset{
		section={  %  设置节标题格式
			name         = {,\hspace{-0.5\ccwd}},
			beforeskip   = 48pt,
			fixskip      = true,
			format       = \centering\heiti\bf\zihao{3},
			numberformat = \heiti\bf\zihao{3},
			afterskip    = 24pt,
		},
		subsection={  %  设置小节标题格式
			name         = {,\hspace{-0.5\ccwd}},
			beforeskip   = 6pt,
			format       = \heiti\bf\zihao{4},
			numberformat+ = \heiti\bf\zihao{4},
			afterskip    = 0pt,
		},
		subsubsection={  %  设置小小节标题格式
			name         = {,\hspace{-0.5\ccwd}},
			beforeskip   = 6pt,
			format       = \songti\bf\zihao{-4},
			numberformat = \bf\zihao{-4},
			afterskip    = 0pt,
		}
	}
	%%=====================================================================================================%%
	%%
	%%                 设置目录深度、格式
	%%
	%%=====================================================================================================%%
	\usepackage{titletoc} %加载目录格式设置宏包
	%==============    设置章节目录格式
	\setcounter{tocdepth}{3}  %设置章节目录深度。article版式没有章层次标题，一级标题为节
	\renewcommand\contentsname{目\hspace{2\ccwd}录}     %修改目录标题
	\titlecontents{section}[0\ccwd]                     %标题名：节，左间距为 0（首行无缩进与突出）
	{\addvspace{.3\baselineskip}\zihao{-4}\heiti}   %标题格式：与上一个标题增加0.3倍行距，小四号黑体
	{\contentslabel{1\ccwd}}                        %标题标志：标题标志宽度为 1个汉字宽度
	{\hspace*{-1\ccwd}}                             %无序号标题格式：前移 1个汉字宽度
	{\hspace{0.5\ccwd}\titlerule*{.}\contentspage}  %指引线与页码：与标题内容间距半个汉字，点填充，页码
	
	\titlecontents{subsection}[1\ccwd]                  %标题名：小节，左间距为 1个汉字宽度（首行无缩进与突出）
	{\addvspace{.3\baselineskip}\zihao{-4}\songti}
	{\contentslabel{1\ccwd}\hspace{1\ccwd}}         %标题标志：标题标志宽度为 1个汉字宽度，后面增加 1个汉字宽度
	{\hspace*{-1\ccwd}}
	{\hspace{0.5\ccwd}\titlerule*{.}\contentspage}
	
	\titlecontents{subsubsection}[2\ccwd]
	{\addvspace{.3\baselineskip}\zihao{-4}\songti}
	{\contentslabel{1\ccwd}\hspace{1.5\ccwd}}
	{\hspace*{-1\ccwd}}
	{\hspace{0.5\ccwd}\titlerule*{.}\contentspage}
	
	%==============    设置插图目录格式
	\renewcommand{\listfigurename}{插图目录}             %修改插图目录标题
	\titlecontents{figure}[0\ccwd]                      %标题名：图，左间距为 0（首行无缩进与突出）
	{\addvspace{.3\baselineskip}\zihao{-4}\songti}  %标题格式：与上一个标题增加0.3倍行距，小四号宋体
	{图~\thecontentslabel{\makebox[3mm]{}}}         %标题标志：标题标志与标题内容间距 3mm
	{}                                              %无序号标题格式：空置
	{\hspace{0.5\ccwd}\titlerule*{.}\contentspage}  %指引线与页码：与标题内容间距半个汉字，点填充，页码
	
	%==============    设置附表目录格式
	\renewcommand{\listtablename}{附表目录}             %修改表格目录标题
	\titlecontents{table}[0\ccwd]                       %标题名：表，左间距为 0（首行无缩进与突出）
	{\addvspace{.3\baselineskip}\zihao{-4}\songti}  %标题格式：与上一个标题增加0.3倍行距，小四号黑体
	{表~\thecontentslabel{\makebox[3mm]{}}}         %标题标志：标题标志与标题内容间距 3mm
	{}                                              %无序号标题格式：前移 1个汉字宽度
	{\hspace{0.5\ccwd}\titlerule*{.}\contentspage}  %指引线与页码：与标题内容间距半个汉字，点填充，页码
	
	%%=====================================================================================================%%
	%%
	%%                 设置脚注显示符号为带圈的数字，大于 10 的不能正常显示
	%%
	%%=====================================================================================================%%
	%\renewcommand{\thefootnote}{\fnsymbol{footnote}}
	\usepackage{pifont}  %加载提供文稿中常见的符号的宏包，选择命令 \ding {代号}
	\usepackage[perpage,stable,symbol*]{footmisc}  %加载自定义脚注符号宏包，每页独立编号，
	\newcommand*\dingctr[1]{\protect\ding{\number\numexpr\value{#1}+171\relax}}  % 调用 \ding 中带圈的数字
	\renewcommand*\thefootnote{\dingctr{footnote}}  % 生成带圈数字脚注，大于 10 的不能正常显示
	
	\makeatletter
	%%%% 悬挂的脚注格式
	\renewcommand\@makefntext[1]{%
		\setlength\leftskip{1.2\ccwd}%
		\setlength\parindent{2\ccwd}\selectfont
		\noindent\llap{\@thefnmark\ }#1}
	%%%% 无悬挂的脚注格式
	%\renewcommand\@makefntext[1]{%
		%    \setlength\parindent{2\ccwd}\selectfont
		%    \@thefnmark\ #1}
	\makeatother
	
	\renewcommand{\footnotesize}{\zihao{-5}}
	
	%%=====================================================================================================%%
	%%
	%%                 其它设置
	%%
	%%=====================================================================================================%%
	
	%==============    默认罗马字体
	\renewcommand{\rmdefault}{ptm}  % pdf架构下设置默认罗马字体为 Times New Roman
	
	%==============    设置公式、图表编号格式
	\numberwithin{equation}{section}  %needs amsmath packge %公式在节内编号
	\renewcommand{\theequation}{\thesection-\arabic{equation}}
	\renewcommand{\thefigure}{\thesection.\arabic{figure}}
	\renewcommand{\thetable}{\thesection.\arabic{table}}
	
	\numberwithin{equation}{section}  % 这样所有公式（不管是 equation 还是 align）都会按照 (章节号.公式号) 的规则编号
	%==============    设置参考文献名
	\CTEXoptions[bibname={参考文献}]
	
	%==============    设置附录名
	\renewcommand\appendix{\par
		\setcounter{section}{0}
		\setcounter{subsection}{0}
		\gdef\thesection{附录 \Alph{section}}}
	
	%==============    定义新的列表环境，使说明文字左对齐，用以排版等
	\newenvironment{newdescription}[1]%
	{\begin{list}{}{\renewcommand{\makelabel}[1]{\songti{##1}\hfil}%
				\settowidth{\labelwidth}{\songti{#1}}%
				\setlength{\labelsep}{0.5\ccwd}%
				\setlength{\parsep}{0pt}%
				\setlength{\itemsep}{2.5pt}%
				\setlength{\leftmargin}{\labelwidth+\labelsep}}}%
		{\end{list}}
	
	%==============    使用 \tikz 定义带圈数字
	\newcommand*\circled[1]{\tikz[baseline=(char.base)]{\node[shape=circle,draw,inner sep=0.2pt] (char) {#1};}}
	
	%==============俄文字母
	\font\ewenb=wncyb10 \font\eweni=wncyi10 \font\ewenr=wncyr10
	\font\ewensc=wncysc10 \font\ewenss=wncyss10
	
	%==============定理设置==============%
	\newtheorem{corollary}{推论}[section]
	\newtheorem{criterion}{Criterion}[section]
	\newtheorem{definition}{定义}[section]
	\newtheorem{example}{例}[section]
	\newtheorem{lemma}{引理}[section]
	\newtheorem{notation}{Notation}[section]
	\newtheorem{proposition}{命题}[section]
	\newtheorem{remark}{Remark}[section]
	\newtheorem{theorem}{定理}[section]
	\newtheorem{assumption}{假设}[section]
	
	%==============定义带左右标号的公式环境==============%
	\makeatletter
	\def\xlabel#1#2{%
		{\@bsphack\protected@write\@auxout{}%
			{\string\newlabel{#2}{{#1}{\thepage}}}%
			\@esphack}{\mathrm(#1)}}
	\makeatother
	%定义结束%
	%下面是一个例子，注意&&的用法%
	%\begin{flalign}
	%\xlabel{H1}{eq:refL}&&x=y+z&&
	%\label{eq:ee1}\\
	%\xlabel{H2}{eq:xxy}&&a=b^2+c^2-a&&
	%\label{eq:ee2}
	%\end{flalign}
	%例子结束%
	
	\renewcommand{\thetheorem}{\thesection.\arabic{theorem}}
	\renewcommand{\thelemma}{\thesection.\arabic{lemma}}
	\renewcommand{\thecorollary}{\thesection.\arabic{corollary}}
	\renewcommand{\theremark}{\thesection.\arabic{remark}}
	\renewcommand{\thedefinition}{\thesection.\arabic{definition}}
	\renewcommand{\theproposition}{\thesection.\arabic{proposition}}
	\renewcommand{\theexample}{\thesection.\arabic{example}}
	
	%==============定义上角标引用参考文献==============%
	\newcommand{\upcite}[1]{\textsuperscript{\cite{#1}}}
	
	%==============定义新函数==============%
	\DeclareMathOperator*{\esssup}{\mathrm{ess}\sup}
	
	%==============设置算法环境==============%
	\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
	\usepackage{bm}
	% \usepackage[ruled]{algorithm2e}
	% 中文替换与格式设定
	\renewcommand{\algorithmcfname}{算法}
	\SetKwInOut{KwInput}{输入}     % 取消缩进的输入
	\SetKwInOut{KwOutput}{输出}    % 取消缩进的输出
	\SetNlSty{}{}{}                % 行号样式（无加粗括号）
	\LinesNumbered                 % 显示行号
	\SetAlCapHSkip{0pt}           % 标题与正文左对齐
	
	\SetAlgoNlRelativeSize{0}  % 控制编号字号
	\SetNlSkip{0.2em}          % 控制编号右边的空隙
	\SetNlSty{textbf}{\ }{}    % 控制编号格式
	
	%==============生成书签==============%
	\usepackage{hyperref}
	
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	%%%%%%%%%%%%%%%%
	%%%%%%%%%%%%%%%%   开始正文区
	%%%%%%%%%%%%%%%%
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	
	\begin{document}

\section*{§1.2 随机模拟算法与 tau-leaping 方法（原文摘录）}
随机模拟算法与 方法
§１
．
２ ｔａｕ－ｌｅａｐｉｎｇ
随机模拟算法 ＳＳＡ 是随机模拟空间均匀化学系统的一种精确策略 它
（ ）
由 Ｄａｎｉｅｌ Ｔ ．Ｇ ｉｌｌｅｓｐｉｅ 首次提出 ＳＳＡ 利用蒙特卡洛方法来近似模拟随机化学系
统的时间演化 ． 对于当前时刻 ｔ ， 系统状态 Ｘ⑷ ％ 且系统具有 Ｋ 个反应通道 ， 每
个通道在当前时刻的反应速率为 为实现状态向量的更新 算法需
． ，
要确定两个关键问题即下一个反应发生的时间 ｔ ＋ Ｔ 与该时刻发生何种反应 ％？． 为
此
，
Ｄａｎｉｅｌ Ｔ ．Ｇ ｉｌｌｅｓｐｉｅ 证实可以通过生成两个随机数 将这两个随机数带入与
倾向函数相关的方程来确定 ｔ ＋ ｒ 与 大量实验表明 ＳＳＡ 可以精确的完成化学
反应系统的随机模拟
．
随后
，
科学家们利用此方法对生化系统进行了大量模拟
［
２（ ＾２２
１．
为使得 ＳＳＡ 更加有效的应用到各种系统中 科学家们对 ＳＳＡ 作出 了诸多改进 例
， ，
如为了减少运算量 ， Ｍ ｉｃｈａｅｌ Ａ ． Ｇ ｉｂｓｏｎ 等人提出 了ＮＲＭ 法 ， 排序直接法等 ［ ２３￣２６ １ ，
为提髙精确度 Ｈａｌｕｋ Ｒ ｅｓａｔ 提出 了具有概率权重的 ＰＳＳＡ 算法等 虽然 ＳＳＡ 精
，
确地模拟了离散随机微观模型 但由于 ＳＳＡ 需要跟踪每一个反应事件 这对于含有
， ，
大量分子物种与反应通道的系统来说 模拟是非常耗时的 因而无法应用到实际生
， ，
活当中
．
ＤａｎｉｅｌＴ ． Ｇ ｉｌｌｅｓｐｉｅ 意识 至ＩＪ 可以采用一个近似方案 ， 以确定的时间步长来推
进该过程
，
而不是对每个反应进行采样
．
为了加快离散随机模拟的速度
，
ＤａｎｉｅｌＴ
．
Ｇ ｉｌｌｅｓｐｉｅ 提出 了 ｔａｕ－ｌｅａｐｉｎｇ 方法 ［ ２８１ 通过设定一些跳跃条件来选定时间步长 ｔ 由
，
ｔ
确定跳跃区间 然后 根据每个反应发生的倾向函数与选定的时间步长
ｔ
来产生
． ，
泊松随机数 利用这些随机数来近似跳跃区间 内可能发生的化学反应次数 这样就
， ．
可以跳过许多反应而不需要跟踪每一个反应事件
．
在某些情况下
，
ｔａｕ－ｌｅａｐｉｎｇ
方法
可以在模拟速度上产生显著的增益
，
但在精度上有可接受的损失
．
ｔａｕ－ｌｅａｐｉｎｇ
方法
提供了从离散随机状态下的 ＳＳＡ 到动力学状态下的化学朗之万方程和连续确定性
状态下的反应速率方程的天然桥梁 ％ 为了使这种加速策略成功应用到化学反应系
．
统的模拟中
，
ＡｂｈｉｊｉｔＣｈａｔｔｅｒ
ｊ
ｅｅ 等人对原始的 ｔａｕ－ｌｅａｐｉｎｇ 方法做出 了改进
，
提出 了
更有效 ， 更稳健的跳跃步长选择策略 ， 如 ： 二项 ｔａｕ－ｌｅａｐｉｎｇ 方法 、 Ｒ －ｔａｕ－ｌｅａｐｉｎｇ 方
法 、 Ｋ －ｔａｕ－ｌｅａｐｉｎｇ 方法等 ． 针对刚性系统 Ｍｕｒｕｈａｎ Ｒａｔｈ ｉｎａｍ、 Ｙａｎｇ Ｃａｏ 等人还提
出 了 隐式 ｔａｕ－ｌｅａｐｉｎｇ 算法 、 自 适应 ｔａｕ 选择方法等等 ［ ２９＿气 ＤｅｓｍｏｎｄＪ ． Ｈ ｉｇｈａｍ
等人将这种方法与计算机软件相结合编译出 了模拟随机化学反应系统的 ＭＡＴＬＡＢ
代码
，
极大提高了计算效率 ％
．
这种
ｔａｕ
跳跃方法在化学动力学和系统生物学领域
中发挥重要作用 科学家们将其应用到随机系统的模拟算法中进行加速 对于由化
， ．
学朗之万方程
（
ＣＬＥ
）
生成的一类 ＳＤＥ
，
这种基于 ｔａｕ－ｌｅａｐｉｎｇ 的模拟方法会加速处
理此类随机微分方程 更加便捷有效的获取各类统计数据 近些年来 一些数学家
， ． ，
们针对不同的随机系统 在
ｔａｕ－ｌｅａｐｉｎｇ
方法的基础上进行推广 提出 了不同的跳跃
， ，
方法 ， 如 ： Ａｂｄｕｌｌｅ Ａ ｓｓｙｒ 等人提出 了 ｔａｕ－ Ｒｏｃｋ 方法 ［ ３８１ 对于带有离散噪声的刚性
随机系统
，
ｔａｕ－ Ｒｏｃｋ 方法可以显著的加速
．
Ｘ ｉｎ
ｊ
ｕｎＰｅｎｇ 等人提出 了加快时滞随机
微分方程
（
ＤＳＳＡ
）
的 ＤｔＬ 方法和 ＤＫ －Ｌｅａｐ 算法 ［ ３９ ， ４Ｑ １． 对于具有快速和慢速时间
尺度为特征的随机系统
，
Ｃｈｉ ｈｅｂ Ｂ ．Ｈａｍｍｏｕｄａ 提出 了多级漂移 ＿ 隐式 ｔａｕ－ｌｅａｐｉｎｇ
方法 ［ ４１ 彳 将 ｔａｕ－ｌｅａｐｉｎｇ 方法应用到了 随机反应网络 （ ＳＲＮ ） － － 某些特定的连续时
间马尔可夫链当 中 为了有效地估计 ＳＲＮ 的各种统计量 特别是罕件事件概率 他
． （ ），
们提出 了基于
ｔａｕ－ｌｅａｐｉｎｇ
的近似方案来提高蒙特卡洛估计器的效率
．

\section*{§2.3 tau-leaping 原理}
§
．
３ ｔａｕ－ｌｅａｐｉｎｇ 原理
考虑在搅拌均匀的化学系统中 具有 ｎ 种反应物种 汾 Ｊ 的化学反应系统
， ｛ ， ，
该系统具有 Ｍ 种化学反应通道 系统的状态 久⑷ 三
其中 足⑴ 表示物种 民 在 ｔ 时刻的分子数 ． 反应 馬 的动力学由倾向函数 ％ 和状
态改变量 ％ 三 （ ｉ ｉｊ，．．．ｉＶ ｊ ． ） 描述 ： ％．〇ｒ ） 出 表示对于给定的初始状态 Ｘ⑷ ＝ 〇；， 反应
尽 在下一个时间段 ［ ｔ ， ｉ ＋ 刹 发生的概率 ， ％ 表示物种 氏 发生 尽 反应的改变量 ．
系统的动力学行为遵循化学主方程 ＣＭＥ
（ ）：
ｄＰ ｘ ＾
＾ ＾° ＝ ＾ ［ ａ＾ｘ－Ｖ ｊ） Ｐ （ ｘ－Ｖ ｊ， ｔ ＼ ｘ 〇， ｔ〇）－ａ ｊ（ ｘ ） Ｐ （ ｘ ， ｔ ｘ 〇， ｔ〇）］，
其中 尸 表示对给定初始时刻的初始状态 文⑷ ＝ 邱 在 （ 时刻 文⑷ ＝ ￥
，
的概率 然而除了一些简单的反应系统之外 化学主方程在计算上是很难处理的 因
． ， ．
此 数学家们采用随机模拟算法 ＳＳＡ 来近似模拟系统的状态演化
， （ ） ：
首先 令
，
Ｍ
ａ ０（ 丨 ） ＝ 〉 ： Ｑ ｊ（ 丨 ），
ｊ＝ｌ
下一个反应发生的时间 Ｔ 是期望值为 的指数型随机变量 反应 尽 发生的概
，
率为
为了模拟系统在时间 ｔ 从状态 ｚ 发生的改变 ＳＳＡ 生成两个均匀分布的随机
， ，
数 ｎ 和 ？ ＇ ２．ｎ 用来产生下一个反应的发生时间 丨 ＋ Ｔ ，
ｔ＝ — ａ 厂 ＾ ＾ ｎ （ — ｎ ）， （ ２．１３ ）
〇（ ）
用来确定发生何种反应
ｒ２
＾２ ａ ｊ（ ｘ ） ＞ｒ ２〇＞ｏ（ ＾ ）－ （ ２．１４ ）
Ｊ＝ｉ
随后 ， 系统更新状态 ＋ ｔ ） ＝ａ： ＋ ％ ．
ＳＳＡ 模拟对每一个单独反应的细致跟踪让我们可以观察到 尤 的完整变化 但
，
是对于现实中存在大量化学反应的随机系统来说 这种构造通常是非常耗时的 因
， ．
此
，
Ｇ ｉｌｌｅｓｐｉｅ 提出 了ｔａｕ－ｌｅａｐｉｎｇ 思想
，
他将时间轴分为一组连续的子区间
，
在这些
子区间 中一些反应的发生对系统的改变是不明显的 在这种情况下 如果可以确定
． ，
每个子区 间每个反应发生的真实次数 就可以放弃了解这些反应发生的精确时刻
， ，
进而从一个子区间跳跃到下一个子区间 而不是从一个反应事件跳到下一个反应事
，
件
．
假设令 ＆ 表示在固定的时间段
［
Ｍ

＋ ｒ
］
内
，
发生 巧 反应的真实次数
．
对于任意的
Ｔ
直接计算 是非常困难的 因此可以选择合适的
Ｔ
使其满
， ． ，
足跳跃条件
：
跳跃条件 这里我们要求
Ｔ
足够小 以至于在 ＋内倾向函数不会发生明显变
： ，
化 ？ 令 ？ ？ （ ＃ （ ０；）， Ｔ ） 为 ／＾ （ Ｔ ； Ｘ ， ｔ ） 的近似 ， 其中 尸 （ ａ ， Ｔ ） 是带有均值 ｏｒｒ 的 Ｐｏｉｓｓｏｎ 随
机变量 反应次数的近似平均值为 本文的附录中将给出证明 则 尤 在此
， （ ），
时间段内发生的变化期望值为
ｎ
。 三 。 （ Ｘ ， Ｔ ） ＝ 土 （ 尤 ） １ ＞ 】 土 ＝
ｊ＝ｌ
其中 办 ） ＝ Ｅ ？＝ｉ 疔 ０ ） １ 土 ， ＜ ＝ 土＂ ？
对于
Ｔ
的选择 主要有两种方法 一种是对每个时间段内 的倾向 函数的变化
， ：
ｇ（ ｘ ＋ Ｇ ， ｙｔ （ ａ： ＋ ｉｊ ）） － 咖 ， ＃ （ ３：）） ， ｊ ＿＝ 进行检查 ， 若差异太大 ， 则尝试较
小的
ｔ
但这个过程可能会比较耗时 对于第二种方法 我们要求倾向 函数在时间
， ． ，
［ ｔ ， ｔ ＋ Ｔ ） 内 的变化差值 ｜ ｇ（；ｒ ＋ ｔｔ；， ｙ＾ ＝ （：ｃ ＋ ａ；）） － ｇ（ ａ：， ｙ ｊ ｔ （ ａ；）） ， ｊ ＿＝ｌ ， ．．． ｎ ， 由所有倾向
函数的和的某个特定分数 倍界定 即
ｅ
，
ｑ（ ｘ ＋ ｕｊ ， ｙｆ（ ｘ ＋ ｕｊ））－ｑ （ ｘ ， ｙｆ（ ｘ ）） ＜ ｅｑ〇（ ｘ ）， ｊ ＝１ ，．．． ｎ ． （ ２．１５ ）
在等式左侧使用泰勒展开式
ｑ（ ｘ ＋ ｕ ， ｙｆ（ ｘ ＋ ｕｊ ））－ｑ（ ｘ ， ｙｆ（ ｘ ））＼ ＾ ０ － Ｖ ｑｆ｛ ｘ ） － ＯＸ
ｉ＝ｉ ｉ
定义 唠⑷ 三 与＾
，
由
（
３．１
）
可得
ｎ
Ｔ⑷唁⑷ 仝 喻⑷
．
Ｉ
ｉ＝ｌ
因此
ｔ
的选择为
ｎ
Ｔ
｛ 叫 。
⑷
／

（ ２－！６ ）
４＝１
利用等式
丨
２ ．１６
丨
选择
ｒ
显然需要耗费一定的计算精力
，
因为这里需要计算
２ｒｉ
个
和
＆
（
Ｘ
）
＆＃
（
〇：）？
选定 Ｔ 之后 ， 由于在 ［ Ｍ ＋ Ｔ ］ 内反应次数呈泊松分布 ［ １９ １ ， 因此可以通过使用泊
松随机数模拟一段时间 内 的反应次数 ， 进而可以跳过许多反应 ． 令 尸 （ ａ ｊ（：Ｃ ）， Ｔ ） 作为
的近似 ， 其中 ＾ Ｐ （ ａ ， Ｔ ） 是带有均值 ａＴ 的 ｐｏｉｓｓｏｎ 随机变量 ？ 所以 ， 对于 ｔ
时刻的状态 Ｘ⑴ ＝ ％ 我们选择合适的 ｔ 满足跳跃条件
，
即可更新 ＋ ｒ
）
处的
状态
：
Ｍ
＾
Ｘ （ ｔ ＋ ｔ ） ＝ｘ ＋ ｙ ｊ Ｖ ｊ Ｐ （ ａ ｊ（ ｘ ）， Ｔ ）， （ ２．１７ ）
ｊ＝ｉ
其中对于每一个 表示均值为
ａ ｊ（ ａ；） Ｔ
的独立泊松随机变量
．
这样的一个计算过程被称为
ｔａｕ－ｌｅａｐｉｎｇ
近似
．
１１

\section*{§3.1 基于空间离散格式的 tau-leaping 算法（原文摘录）}
§
．
１ ｔａｕ－ｌｅａｐｉｎｇ 算法
考虑带有加法噪声的 维随机微分方程
ＴＺ
ｄＸ ｔ＝ ＾ （ Ｘ ｔ） ｄｔ ＋ ａｄＷ ｔ， （ ３ ．１ ）
其中 Ｗ
＊
是 ｎ 维的 白 噪声
，
： Ｒ＂ —■ Ｒｎ 和 ａ： Ｒ？ ４ 吧１ 分别为漂移项和常系数扩
散项
．
ＳＤＥ （ ３．１ ） 的解 ｛ Ｘ山 ｅ ［ Ｑ ， Ｔ ］ 是一个随机过程 ， 其在时间连续下的空间离散过程
可以看作是质点粒子 从初始位置出发
，
在
ｌ
〇
，
Ｔ
］
内 的运动过程
．
对于 Ｎａｗａｆ Ｂｏｕ－
Ｒａｂｅｅ 和 Ｅｒｉｃ Ｖａｎｄｅｎ－ Ｅ ｉｊ ｎｄｅｎ 等人提出 的空间离散 ｇ 方法
，
考虑 在连续时间
上的空间离散化 质点 尤 在
ｎ
维网格空间中进行随机游走 在
ｔ
时刻所处的位置为
， ，
尤
＝ （
尤
， ， ．．．
尤
？；）．
下一时刻质点按照
Ｑ
算法进行跳跃
，
在任一维方向 中选择前进或
后退一步 然而 质点每跳跃一步 算法都需要重新计算倾向 函数和跳跃时间 跳跃
． ， ， ，
方向等 我们的模拟需要长时间观察解的动力学行为 这对模拟工作来说是非常耗
． ，
时的 因此 我们借助化学反应系统中的随机模拟方法 将 ｎ 维网格空间看成是包含
． ， ．
ｎ 种化学物种 ＆ ＆ 的化学系统 具有 加 个反应通道
｛ ， ？？？ ｝ ， ：
每次只有一个物种发生反应
．
在每一个反应时刻
，
第
ｉ
个物种选择 或者 ＡＣ 反
应通道进行反应 ． 从这个观点出发 ， 借助 Ｄａｖｉｄ Ｈ ．Ｇ ｉｌｌｅｓｐｉｅ 提出的随机模拟化学反
应系统的加速
ｔａｕ－ｌｅａｐｉｎｇ
算法
．
我们提出 了基于
＜５
方法的加速策略
．
首先
，
根据空间离散
＜３
算法计算出各个方向的倾向函数
ｇ〇ｒ
，
＝１
，
，
… ｎ ）， 咖 為 土⑷⑷ 表示对于给定的初始状态 文⑷ ＝ ａ；， 在下一个时间段 ［ 匀 ｔ ＋ ｄｔ ］，
质点由 ｚ 跳跃到 ＃㈦ 的概率 ． 计算状态改变量 ％ 三 （ ％ ， ．．． ％ ；）， 其中 ％ 表示质点
跳跃到 ＃ 后 ， 第 ｉ 维的状态改变量 ． 选择满足跳跃条件的时间步长 Ｔ ． 将时间轴
分为多个连续的子区间 使得在时间子区间 ＋内 一些跳跃的发生对系统的改
， ，
变是不明显的 在这种情况下 如果我们可以确定每个区间段内 在各个方向 的近
． ， ，
似跳跃次数 我们就可以放弃了解这些反应发生的精确时刻 进而从一个时间子区
， ，
间跳跃到下一个子区间 计算多次跳跃的结果 而不是每次都进行跳跃 这样就可以
， ， ．
大大加快模拟的速度
．
令 Ｋ ｊｆ ｒｒＪ
）
表示在固定的时间段 ＋内
，
发生跳跃的真
实次数 对于时间步长
ｔ
直接计算 是非常困难的 我们知道在每个时间
． ， ．
区间 内 质点的跳跃次数是呈泊松分布 ［ ２８ ］ 的 且泊松分布的参数为 ⑷ ＊ｔ
， ， ）
（ 证明见附录 ）． 因此 ， 我们将通过使用泊松随机数 ＆ （ Ｔ ； ：ｒ ， ｉ ） 来近似一段时间 内 的跳
跃次数 ， 这样将会减少计算次数 ， 提高随机模拟的速度 ？ 然后 ， 用 七 ＋４ ＝ Ａ ＋巧％
来近似计算这段时间 内 的实际位移 ｌ （ｔ＋Ｔ ）ｊ ＝． 更新状态和时间之后继续
进行下一时间段内 的跳跃
．
算法的主要步骤为
：
步驟 １： 选择符合跳跃条件的 Ｔ
，
生成平均值为 咖
，
＃
（
〇；）） 的 ｐｏｉｓｓｏｎ 随机数
Ａ＾ ， （ ｉ＝１ ， ．．． ｎ ）， 用来近似在时间 ［ Ｍ ＋ 爿 内系统在第 《 个位置前进或后退的
次数 其中下一状态的倾向函数
， ：
Ｑ ｃ？
咖 ＃ ）） ＝ 昝 ｅｘｐ １ ＾ ，
 （ ）
＾
ｑ（ ｘ ， ｙ ｒ （ ｘ ）） ＝ ＾ ｅＷ （ － ） ，
Ｑ ｕ？
咖 队 ＋⑷ ＝ 糾 ⑷ ｖ 〇 ＋ 令
， ） ｜（（ ） ），
Ｑ（ ｘ ， ｙｉ（ ｘ ）） ＝ ＾（ － （／ ｉｉ（ ｘ ） Ｖ ０ ） ＋

＾ ），
步骤 更新状态
：
＋ Ｔ ） ＝ Ｘ⑷ ＋ Ａ＊／ｉ＝ Ｘ⑷ ＋ （ Ａ＾－ 入 ＾ ＂－Ａ ｆ， … ４ －Ａ Ｓ） ＊ 心 （ ３ ． ２ ）
步骤 ３ ： 更新时间 ： ｔ ｔ ＋ ｔ ， 统计各个网格点处的数据 ， 继续下一次循环 ．
步骤４ 生成个各网格点处的概率密度函数
： ．
在计算机中实现的主要代码如算法 所示
１ ：
Ａ ｌｇｏｒｉｔｈｍ１ｎ 维 ＳＤＥ 数值平稳密度的 ｔａｕ－ｌｅａｐｉｎｇ 算法
输入 ： 状态下界 ｌｏｗｘ ， 样本容量 Ｓｐ ， 网格数量 Ｎ ， 停止时间 ｔ ＊ ， 初始状态 文 〇，
零矩阵
ｄａｔａ
＾ｗ ，…ｘＡｒ 计数
ｎｕｍ
，
输出
：
不变概率密度
ｄａｔａ
１： ｆｕｎｃｔｉｏｎｔａｕ－ｌｅａｐｉｎｇ （ １ｏｗｘ ， Ｓｐ ， Ｎ ，ｔ ＊ ， Ｘ 〇）
２： ｗｈ ｉｌｅｔ＜ｔ ＊ｄｏ
３： ｆｏｒ ｊ： １—＞ｎｄｏ
４ 利用 Ｑ 方法计算 ＜ 和
： ；
５：
生成泊松随机数
？ ｐｏｉｓｓｏｎ
＾
ｑ＾ Ｔ
） ；
６： 更新状态变化量 ？＜— 文 ＋ Ａ ｊ Ｖ ｊ ） ；
７： 记录质点落入的网格点 ： ｇ ｊ ｒｏｕｎｄ （（ 文 ｔ ｊ －（ｌｏｗｘ ）』 ＋ ｈ ／ ２ ． ０ ）／ ｈ ） ；
８： ｅｎｄｆｏｒ
９： ｉｆ ｇｘ ＞１ａｎｄ ｇ ｌ ＜＝ Ｎ ，ｇ２ ＞１ａｎｄ ｇ２ ＜＝ Ｎ ，．．．ｇｎ ＞１ａｎｄ ｇ？ ＜＝ Ｎ ｔｈｅｎ
１０： ｄａｔａ （ ｇ ｌ５ ｇ２， ．．．ｇｎ） ＾ｄａｔａ （ ｇ１， ｇ２， ．．．ｇｎ） ＋１ ；
１１： ｎｕｍ？＜—ｎｕｍ ＋１
；
１２： ｅｎｄｉｆ
１３： ｔ ｔ＋ｒ；
：
ｅｎｄｗｈ ｉｌｅ
１５：
计算概率密度函数
ｄａｔａ—ｄａｔａ ／（ ｈ
ｎ
ｘｎｕｍ ） ；
１６： ｅｎｄｆｕｎｃｔｉｏｎ

\section*{§3.3 中点格式的 tau-leaping 算法（原文摘录）}
§
．
３ ｔａｕ－ｌｅａｐｉｎｇ
在第
２．３
节中
，
我们给出 了选择
Ｔ
的跳跃条件
，
该条件要求倾向函数在时间
Ｔ
内无明显变化 但是在实践中我们发现 如果我们要采取较大的跳跃来产生比
ｇ
算
， ，
法更快的模拟 总是会产生一些倾向函数的变化 这些变化将会不可避免的引入一
， ，
些误差
．
当我们用简单的欧拉方法数值求解形如 ｄＸ ／ ｄｔ＝ ／ 丨 Ｘ 丨 的常微分方程时 ， 会出
现类似的困难 ． 其中 尤 根据 ＝ Ｘ⑷ ⑴ ） Ａ ｔ 沿着时间轴跳跃时 ， 只要
函数
／
在 Ａ
ｔ
增量期间发生变化
，
就会产生误差
．
减少这种误差的一种方法是使用估
计中点的程序改进 ： 厶 １ 文 ＝ １ ／（ ； ＾ ）） ？ ， 令 ； ＾ ＋ ？ ） ＝ ￥ （ ） ＋ ／ （ 文 （ 〇 ＋ ０ １ 文 ） ？ ．
为了使这种估计中点策略适应 ｔａｕ－ｌｅａｐｉｎｇ 方法 我们将状态的预期变化量 Ｇ
，
类似欧拉增量 ／＾又
，
在跳跃过程中取 ：ｃ ＋ 向 ／２
］
作为估计的中点状态
，
因此我们在
时刻
ｉ ，
从状态
ｚ
跳跃的中点估计方法如下
：
步骤 １： 对于符合跳跃条件的 Ｔ ， 计算在 ｋ， ｔ ＋ Ｔ ） 状态的预期变化量 Ｄ
步驟２ ： 令 壬 ＝ ｘ ＋ ［ ｉＤ ／ ２ ］． 生成平均值为 斤⑷ ＊１■ 的 ｐｏｉｓｓｏｎ 数 年
步骤 ３ ： 计算实际状态变化量 ｗ＝ ＆ ＿ 更新状态 ： 又 （ ｔ ＋ ｒ ） ＝ Ｘ⑷ ＝ｘ＋ ｃｊ ．
步骤４ ： 更新时间 ： ｔ ｔ ＋ Ｔ ， 统计各个网格点处的数据 ， 继续下一次循环 ．
步骤
生成个各网格点处的概率密度函数
： ．
表 ３ ． ６ ： ＳＤＥ （ ３．３ ） 在不同参数下 Ｑｃ－ｔａｕ－ｌｅａｐｉｎｇ 与中点格式的 Ｑｃ－ｔａｕ－ｌｅａｐｉｎｇ 方法的
Ｐ 误差及 ＣＰＵ 运行时间的比较
．
丁 ｔｓｔ〇ｐ ＮＭ ｅｔｈｏｄ Ｐ－ｅｒｒｏｒ ＣＰＵ ｔｉｍｅ（ ｓｅｃ
）
０ ．０１２０００００３０Ｑ ｃ－ｔａｕ－ｌｅａｐｉｎｇ ０．０１０１ ９．９５
０．０１２０００００３０Ｑ ｃ－ｍｉｄ－ｔａｕ－ｌｅａｐｉｎｇ ０．００８４１１． ３４
．
０１２０００００６０Ｑ ｃ－ｔａｕ－ｌｅａｐｉｎｇ ０．００７４１２．２１
０．０１ ２０００００６０Ｑ ｃ－ｍｉｄ－ｔａｕ－ｌｅａｐｉｎｇ ０ ．００５９ １６．２８
０．０５２０００００３０Ｑ ｃ－ｔａｕ－ｌｅａｐｉｎｇ ０．０４２９ １．３１
０．０５２０００００３０Ｑｃ－ｍｉｄ－ｔａｕ－ｌｅａｐｉｎｇ ０．０２６８ １．９２
０． ０５２０００００６０Ｑ ｃ－ｔａｕ－ｌｅａｐｉｎｇ ０ ．０３２８３．２０
０．０５２０００００６０Ｑ ｃ－ｍｉｄ－ｔａｕ－ｌｅａｐｉｎｇ ０．０１２８４ ．７８
〇
°
－３
＊ ４
ｒ


ＡＡ
＿ｔ■ｉ？ ？迷
＾

車
ｔ
Ｑ Ｑ
ｒｕ
ｃ ｃ
ｅ
 ｔ ｍ

ａ
ｓ
ｕ ｉ
ｏ
ｄ
ｌｕ
ｌｅ ｔ
ｔ
ａ ａ
ｉｏ
ｕ ｐ
ｎ
ｉ ｌ ｎ ｅ ｇ ａｐｉｎｇ

＼
°－°５ｙ
ＯＨｔＳ－ｅ Ｃｙ
－３ －２ －１ ０ １ ２ ３
Ｘ
图 ３．６： ＳＤＥ （ ３．３ ） 基于中点格式的不变概率密度函数 ．
对于
．
节中 的带加法噪声的一维立方振荡器
（
．
），
为了减小
ｔａｕ－ｌｅａｐｉｎｇ
算
法的模拟误差
，
我们采用 了本节提出 的 中点格式的 ｔａｕ－ｌｅａｐｉｎｇ 方法
．
这里我们仍
在 基础上进行 ｔａｕ－ｌｅａｐｉｎｇ 模拟 模拟在 ７Ｖ＝１〇〇 的网格点上进行 状态空间
， ，
Ｄ＝ 卜３
，
礼 模拟的空间步长是均匀的 ｈ＝０
．
，
停止时间 ＝２０００００
，
初始状态
＝２
，
选取跳跃步长 Ｔ＝０．０５． 图 ３
．
６ 展示了 中点格式算法的不变概率密度函数
与原来的 Ｑ ｃ－ｔａｕ－ｌｅａｐｉｎｇ 方法的 比较
，
其中带星号的 曲线为中点算法
，
带圆 圈 的曲
线为 （５ｃ－ｔａｕ－ｌｅａｐｉｎｇ 方法
，
红色曲线为真实的平稳密度曲线
．
由 图可见
，
中点算法曲
线更加贴合真实的平稳密度曲线
．
在不同参数下
，
我们与
Ｑ ｃ－ｔａＵ－ｌｅａｐｉｎｇ
算法进行了１００ 次数值模拟比较
．
表
．
２１
中 的数据表明 中点格式的方法明显缩小了误差 但在模拟速度上由于中点格式的算
，
法增加了计算步骤
，
因此运行时间会比
Ｑ ｅ－ｔａｕ－ｌｅａｐｉｎｇ
方法长
．
结合表
３ ．１、 ３． ２
可
看出 中点格式的
Ｑ ｃ－ｔａｕ－ｌｅａｐｉｎｇ
方法仍然比 方法要快
．
２２

\section*{§3.4 带拒绝机制的 tau-leaping 算法（原文摘录）}
§
．
４ ｔａｕ－ｌｅａｐｉｎｇ
我们的算法在进行步长跳跃时 要求在 ＋内倾向函数不会发生明显变化
， ．
然而在实际的模拟实验中 往往会出现
Ｐｏｉｓｓｏｎ
跳跃次数过大的情况 此时显然不
， ，
满足跳跃条件 此外 跳跃次数过大 也会使得质点跳跃时跑出边界 从而跳跃无效
． ， ， ， ．
在数值模拟化学系统时也出现过类似的 问题
，
为此 ＤａｖｉｄＦ
．
Ａｎｄｅｒｓｏｎ 等人提出 了
跳跃后检查的机制 受此启发 为保证算法有效性 我们提出 了带有拒绝机制的
， ，
ｔａｕ－ｌｅａｐｉｎｇ 算法
．
算法将基于前一次跳跃的成功或失败来 自 适应的选择 ｔ
．
首先
，
明
确时间步长
ｔ
计算各个方向 的倾向函数 其次 我们将通过使用泊松随
， ，
机数 Ｐｊ（ ｒ ； 〇：， ｔ ） ？ ｐｏｉｓｓｏｎ （ ％ ＊ｔ ） 来近似一段时间 内 的跳跃次数 ， 这里我们对每个区
间段 ＋的跳跃次数加 以上界限制 上界的选择 我们是根据对质点轨迹的多
丨 ． ，
次观察得到的
．
假如生成的 ｐｏｉｓｓｏｎ 跳跃数小于上界
，
我们将进行正常的 ｔａｕ－ｌｅａｐｉｎｇ 跳跃
．
用
知 ＋１＾ ＝ 尤 』 ＋ 巧．％ 来近似计算这段时间 内 的实际位移 文 （ｔ＋４ ＝ ４ ？ 假如
ｐｏｉｓｓｏｎ 跳跃数超过上界 我们将选择一个更小的时间步长 Ｔ＇ ＜Ｔ 使其在 ＋
， ，
内跳跃次数不会太大 并尝试在这个较短的时间段内进行跳跃 已知在 ＋内
， ． ，
泊松跳跃的次数为
巧 ．
因此
，
想要计算在 ＋的跳跃次数
片 ，
应该以
巧
为条
件
．
引理 ３ ． ４ ．１ 令 ｙ⑷ 是一个带有参数 Ａ 的 ｐｏｉｓｓｏｎ 过程 ， 且 则
在已知 Ｙ⑷ 和 ： Ｋ⑷ 的条件下 ， －１ ＂⑷ 具有二项式分布 ＿ Ｙ （ ｓ ）， ｒ ）， 其
中 ｒ＝ （ ｉｔ＿ｓ ）／（ ｔ＿ｓ ）．
由 引理 ３ ．１ （ 证明可见附录 ）， 我们可知 ｐ 丨 的分布为二项分布 ｂｉｎｏｍｉａｌ ＾ ， ？ － ）， 其
中 ｒ＝ｔ＇
／
ｔ
．
跳跃之后继续更新状态 ＋ 巧％
，
进行下一次循环
＿
因此 ， 对于当前时刻 ｔ ， 质点位置 尤 ＝〇；， 上界 ｂｏｕｎｄ ， 我们的方法如下 ：
步骤
１：
选择满足跳跃条件的
ｔ．
步驟 ２ ： 由 Ｑ 算法计算各个方向 的倾向函数 （ ａ：））．
步骤３ ： 生成泊松随机数 Ａ ’（ Ｔ ； ａ；， 幻 ？ ｐｏｉｓｓｏｎ （ｇ（：ｃ ， ｙｆ（；ｒ ）） ＊ｔ ）．
步骤４ ： 如果 ， ｜ Ａ ／ －Ａ Ｊ ＜ｂｏｕｎｄ ， 更新状态４ ＝ ＆ ＋ （ Ａ ／ ＊ ＜ ＋ Ａ ｆ ＊ ｆ ）；
否 贝 Ｉｊ，ｔ＇＝ｍａｘ （ ｌ／ Ａ ｆ， ｌ／ Ａ ｆ），ｔ＝ｔ’ ，
生成二项分布的随机数 ｆ ， Ａｆ ？ ｂｉｎｏｍａ＾Ａ ＾＾ Ｔ＇ ／ Ｔ ），
更新状态 ４ ＝ 心 ＋ （ Ａｆ ＊ ＜ ＋ Ａｆ ＊ ｆ ）．
步骤 ５： 更新时间 ： ｉ ｔ ＋ ｒ ， 统计各个网格点处的数据 ， 继续下一次循环 ．
表 ３． ７ ： ＳＤＥ （ ３．３ ） 在不同参数下 ｔａｕ－ｌｅａｐｉｎｇ 与带拒绝机制的 Ｑｆ －ｔａｕ－ｌｅａｐｉｎｇ
的 Ｐ 误差及 ＣＰＵ 运行时间的比较
．
ｒｔｓｔ〇ｐ ＮＭ ｅｔｈｏｄ ＾－ｅｒｒｏｒ ＣＰＵ ｔｉｍｅ（ｓｅｃ
）
０．０１ ２０００００３０Ｑ＾ ｚ －ｔａｕ－ｌｅａｐｉｎｇ ０．０７０９ １２．８９
０．０１ ２０００００３０Ｑ ＾ －ｔａｕ－ｌｅａｐｉｎｇ－ｒｅ
ｊ
ｅｃｔ ０． ０４５８９ ．３３
０ ．０１ ２０００００６０Ｑ ＾ －ｔａｕ－ｌｅａｐｉｎｇ ０．０３００４８．９０
０ ．０１ ２０００００６０Ｑ ＾ －ｔａｕ－ｌｅａｐｉｎｇ－ｒｅ
ｊ
ｅｃｔ ０． ０２６８ １１． ７６
０．０５２０００００３０Ｑ ＾ －ｔａｕ－ｌｅａｐｉｎｇ ０．０６７７２．０３
０．０５２０００００３０Ｑ ＾ －ｔａｕ－ｌｅａｐｉｎｇ－ｒｅ
ｊ
ｅｃｔ ０．０６９６ １．１０
０．０５２０００００６０ｇ＾ ｚ －ｔａｕ－ｌｅａｐｉｎｇ ０．０７０９ １２．８９
０．０５２０００００６０Ｑ＾ ｚ －ｔａｕ－ｌｅａｐｉｎｇ－ｒｅ ｊ ｅｃｔ ０． ０４９１ ４ ． ０５
步骤
生成个各网格点处的概率密度函数
： ．
０ ． ４０ 
° ３５ 
／ ＼
０ ． ３０ ／ ＼
 
，． ２５＿ ／ ＼
〇３
０ ．２０ －
——
ｔｒｕｅｓｏｌ
ｔ
ｕ
ａ
ｔ
ｕ
ｉｏｎ
ｌｅａｐｉｎｇｗｉｔｈｒｅｊｅｃｔｄ ｉｓｔｒｉ ｂｕｔｉｏｎ
＇
／ ＼
．
０５￣／ ＼
’ 、
．
—３—２ —１ ０１２３
Ｘ
图 ３． ７
：
基于带有拒绝机制的 Ｑｆ ｔａｎ－ｌｅａｐｉｎｇ 方法进行模拟的不变概率密度函数
．
我们仍然以带加法噪声的一维立方振荡器模型为例
，
用 ｐｙｔｈｏｎ 运行 ３．１ 节提
出 的 Ｑｆ －ｔａｕ－ｌｅａｐｉｎｇ 方法时 我们发现此时质点大部分将会超出边界 此时无法进
， ，
行数值模拟
．
因此
，
我们釆用了本节提出 的带有拒绝机制的
Ｑ ｕ－ｔａｕ－ｌｅａＰｉｎｇ
方法
，
成
功实现了模拟运行
．
模拟在 ｉＶ＝３０ 的网格点上进行
，
状态空间 Ｄ ＝［ －３
，
］，
模拟的
空间步长是均匀 的 ／ｉ＝０ ． ２ ， 初始状态 ＝０． 我们取 ＝２０００００ ， Ｔ＝０ ． ０５．
如 图 ３． ７ ， 我们给出 了ＳＤＥ （ ３．３ ） 基于带有拒绝机制的 Ｑｆ －ｔａｕ－ｌｅａｐｉｎｇ 方法进
行模拟的不变概率密度函数曲线与真实解的平稳密度 曲线 其中黄色曲线为真实解
．
的不变概率密度函数 蓝色线为基于带有拒绝机制 的 Ｑｆ －ｔａｕ－ｌｅａｐｉｎｇ 方法进行模
，
拟的不变概率密度函数
．
由 图可见我们的算法成功避免了 Ｑｆ －ｔａｕ－ｌｅａｐｉｎｇ 方法所
出现的 问题
．
为了更好的 比较误差
，
我们取了１００ 次平均
，
由表格
３． ７
可见
，
在误差
可以接受的范围 内
，
运行时间将 Ｑｆ －ｔａｕ－ｌｅａｐｉｎｇ 的运行时间将大大缩减
．
对于其他空间离散算法 在运行过程中也会出现相同的 问题 我们提出 的带拒
， ，
绝机制的空间离散算法可以很好的避免此问题
．
２５

\section*{§4.1 扩散项为小参数的 tau-leaping 方法：主要算法（原文摘录）}
第 四章 Ｓ ＤＥ扩散项为 小参数 的 ｔａｕ－ｌ ｅａｐｉ ｎｇ 方法
传统的 ｇ 方法不适应于扩散项为小参数 ｅ 的 ＳＤＥ 问题 ， 针对此类 ＳＤＥ ， 我们
提出 了尺度化的空间离散 ｔａｕ－ｌｅａｐｉｎｇ 方法
，
并且对二维 Ｒ ｉｎｇ ｄｅｎｓｉｔｙ 模型进行了
应用 由多次试验表明我们的算法对于模拟此类随机微分方程是非常有效的且大大
．
提高了模拟效率
．
此外
，
这种改进的
ｔａｕ－ｌｅａｐｉｎｇ
算法同样还适应于吸引域比较大的
随机扰动 Ｌｏｒｅｎｚ 振子模型 我们在第三节中成功模拟出 了此类模型的不变概率密
，
度函数 解决了空间离散 ｇ 算法不适用 的 问题
， ．
主要算法
§ ４ ．１
考虑动力系统的长时间行为或非正常行为时 往往需要考虑 ＳＤＥ 扩散项为 ｅ
，
小参数问题 假设带有加法噪声的
ｎ
随机微分方程
．
ｄＸ ｔ＝ ｆ ｉ （ Ｘ ｔ） ｄｔ ＋ ａｄＷ ｔ， （ ４ ．１ ）
其中 Ｗ
＊
是 ｎ 维的 白 噪声
，
： Ｒ＂ ４和 ａ： Ｒ＂ ４分别为漂移项和常系数扩
散项 ， （Ｔ 《 １ 为小参数 ．
在空间离散方法中 方法是二阶精度的 但是当
ａ
非常小时 方法显然不
， ， ，
再适用 对于 方法 计算精度又达不到我们的要求 因此 我们考虑使用 Ｑｆ 方
． ， ． ，
法 ． 为保证 Ｑ严 方法是二阶精确的 ， 需要满足 ａ２ － ｜／／ （ 〇；） 叫 ＞０ ． 因此 ， 要使得 Ｑｆ
满足二阶精度 相应的需要模拟的网格长度 非常小 这就会导致运算速度减慢 本
， ， ．
节我们提出使用 ｔａｕ－ｌｅａｐｉｎｇ 方法 选定合适的 ｔ 通过生成泊松数计算一段时间 内
， ，
的近似跳跃次数来实现多步位移 进而提髙运算速度 算法的主要思想和第三章中
， ．
提出 的 ｔａｕ－ｌｅａｐｉｎｇ 相似 主要区别在于空间步长的选择 以及在不变概率密度函数
， ，
的实现上有所不同
．
例如
：
对于当前时刻
ｔ ，
质点位置 尤
＝ （；ｒ ， ｙ ）， ｎ＝２ ．
步骤 １： 选择符合跳跃条件的时间 ｔ
，
根据 算法计算
（
４ ．１
）
的 风
，
然后在加细
网
格
＝ｈ ／ｓｃａ〖ｅ
上生成各方向 的倾向函数
：
， 吣 〇ｒ ）） ＝ｌ／／ｉ＿（ ｍａｘ （ ＂ ｉ， ０ ） ＋
ｑ（ Ｘ ｉ ， ｙｊ（ ｘ ）） ＝ｌ／／ｉｎｅｕ）（ －ｍｍ （／ｉｉ， ０ ） ＋ Ｍ ｉ／ ｈ ｎｅｗ），
９（ 工 ｉ， Ｚ／ｊ（ 尤 ）） ＝
ｑ｛ ｘ ｉ， ｙｊ（ ｘ ）） ＝ｌ／Ｚｉｎｅ＾＾ｍｉｎ＾ ｊ Ｏ ） ＋ Ｍ ｊ／ ｈ ｎｅｗ）．
步骤２ ： 生成 ｐｏｉｓｓｏｎ 随机数 Ａ ？？ ｐｏｉｓｓｏｎＷ ； ＾ ， ％． ） ！＂ ）， ｎ＝ （ ｌ ， ２ ， ３ ， ４ ）？
步驟３ ： 更新状态 ： 又 （ Ｚ ＋ Ｔ ） ＝ 文⑷ ＋ （ Ａ ｌ — Ａ ２ ＋ ■ ＾３ — ■＾４） ＊ ／ｉ．
步驟４ ： 更新时间 ： ｔ＝ｉ ＋ Ｔ ．
步骤
５ ：
在原来的网格
／ｉ
上统计数据
，
生成近似的不变概率密度函数
．
Ａ ｌｇｏｒｉｔｈｍ２ 扩散项为小参数的二维 ＳＤＥ 的 Ｑｆ －ｔａｕ－ｌｅａｐｉｎｇ 算法
输入 ： 状态下界 ｌｏｗｘ ， ｌｏｗｙ ， 样本容量 Ｓｐ ， 网格数量 Ｎ ， 停止时间 ｔ ＊ ， 步长 ｔ ， 零矩
阵 ｄａｔａ ２ｘ２ 计数 ｍｉｍ
，
输出
：
不变概率密度
ｄａｔａ
１： ｆｕｎｃｔｉｏｎ２Ｄ －ｔａｕ－ｌｅａｐｉ ｎｇ （１ｏｗｘ ，ｌｏｗｙ ， Ｓｐ ， Ｎ ，ｔ ＊ ， ｘ 〇，ｙ〇，ｒ ）
２： ｔ？＜—０ ， ｈ－＜—Ｓｐ／ Ｎ ， ｈ＊ ＜—ｈ ／ｓｃａｌｅ ， ｘ ｎ？＜—０ ，ｙｎ？＜—０ ；
３： ｘ—ｌｏｗｘ－ｈ＊ ／ ２ ． ０ ＋ｒｏｕｎｄ （（ ｌ－ｌｏｗｘ＋ｈ＊ ／ ２ ． 〇 ）／ ｈ＊ ） ｈ＊ ；
４ ： ｘ＜ｒ－ｌｏｗｙ－ｈ＊ ／ ２ ． ０ ＋ｒｏｕｎｄ （（ ｌ－ｌｏｗｙ＋ｈ＊ ／ ２ ． ０ ）／ ｈ＊ ） ｈ＊ ；
５： ｗｈ ｉｌｅｔ＜ｔ ＊ ｄｏ
利用 Ｚ 方法计算
６： Ｑ〗 ｑ
ｉ，
ｑ２， 
；
７： ０ ． ５ｍａｘ （ ｅｐｓ－ａｂｓ （／ｉｉ） ｈ＊ ， ０ ），ｉ １ ， ２；
８： —ｒ （ 士ｍａｘＯ＾ Ｏ ）／！！ ＊ ＋ Ｍ ｌｌｙ ／ （ ｈ＊ ｈ＊ ）） ；
９： ｑ３， ｑ４ —ｔ （ 士ｍａｘ （ ＂２， ０ ）／ ｈ＊ ＋ Ｍ ２２ ＂ｈ＊ ｈ＊ ）） ；
１０： 计算四个方向 的泊松随机数 ： Ａ ｉ ｔ ｐｏｉｓｓｏｎｈ ）， （ｉ—１ ， ２ ， ３ ， ４ ） ；
１１： 更新状态 ： ｘ？＜—ｘ＋ （ Ａ ｉ—Ａ ２） ｈ＊ ；ｙ？＜—ｙ ＋ （ Ａ ３—Ａ ４） ｈ＊ ；
１２： 记录质点落入的网格点 ： ｘ ｎ —ｒｏｕｎｄ （（ ｘ－ｌｏｗｘ ＋ ｈ ／ ２ ． ０ ）／ ｈ ） ；
１３： ｙｎ＜ｒ－ｒｏｕｎｄ （（ ｙ－ｌｏｗｙ ＋ ｈ ／ ２ ．０ ）／ ｈ ） ；
１４ ： ｉｆｘ ｎ ＞＝１ａｎｄｘ ｎ ＜＝Ｎａｎｄ ｙｎ ＞＝１ａｎｄ ｙｎ ＜＝Ｎ ｔｈｅｎ
１５： ｄａｔａ （ ｘ ｎ， ｙｎ） —ｄａｔａ （ ｘ ｎ， ｙｎ） ＋１ ；
１６： ｎｕｍ？＜—ｎｕｍ ＋１
；
１７： ｅｎｄｉｆ
１８： ｔ—ｔ＋ｔ；
１９： ｅｎｄｗｈ ｉｌｅ
２０： 计算概率密度函数 ｄａｔａ—ｄａｔａ ／（ ｈｘｈｘｎｕｍ ） ．
２１： ｅｎｄｆｕｎｃｔｉｏｎ
２７

\end{document}
